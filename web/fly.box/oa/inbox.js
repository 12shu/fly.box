!function () { var _ = fly, A = _.getQuery("day"), $ = ["<div id=top-empty></div><div id=\"title-block\">", A ? "<label><input type=checkbox onclick=page.showAllDay() checked />\u4ec5\u663e\u793a{0}</label>".format(new Date(A).format("yyyy\u5e74MM\u6708dd\u65e5")) : "", "<input id=chk-noReceive type=radio name=chk-filter  /><label for=chk-noReceive >\u672a\u63a5\u6536</label> ", "<input id=chk-processing type=radio name=chk-filter /><label for=chk-processing >\u529e\u7406\u4e2d</label> ", "<input id=chk-completed type=radio name=chk-filter /><label for=chk-completed >\u5df2\u529e\u7ed3</label> ", "<input id=chk-all type=radio name=chk-filter checked /><label for=chk-all >\u6240\u6709</label> ", "<a class=submit-button href=\"list.htm?m=oa&list=outbox\" style=\"margin-left:100px\">\u6211\u53d1\u8d77\u7684</a> ", "<a class=submit-button href=\"form.htm?m=oa&form=outbox-form\">\u65b0\u5efa\u901a\u77e5\u3001\u516c\u544a...</a> ", "</div>", "<div id=\"list-container\" class=\"nolink a-button\">", "</div>"].join(""); _.box.InboxList = _.Class({ name: "\u4e8b\u52a1", title: "\u4e8b\u52a1", base: _.base.ListBase, form: "outbox-form", pageFormat: $, service: "work", pageUrl: _.base.ajaxUrl("work", "Inbox", A ? "day=" + A : ""), removeAction: "InboxDelete", isFirstLoadData: true, setStateFilter: function () { var $ = this.stateBoxs.filter(":checked"); this.store.params.state = $[0].id.substr(4) }, createMembers: function () { this.$base.createMembers.apply(this, arguments); this.stateBoxs = _("#title-block input"); this.setStateFilter(); this.stateBoxs.click(function () { this.setStateFilter(); this.pager.go(0, true) }, this); this.store.onRequested(function ($) { if (this.isFirstLoadData && $.data.length == 0) setTimeout(function () { _("#chk-processing").attr("checked", true).fire("click") }); this.isFirstLoadData = false }, this) }, showAllDay: function () { location.href = location.href.replace("day=", "___day=") }, remove0: function ($) { }, createGrid: function () { var $ = this; function A($, A) { var _ = A.record, D = _.url, B = "_self"; if (D) { var C = D.indexOf("|"); if (C > -1 && C < 10) { B = D.substr(0, C); D = D.substr(C + 1) } else B = "_blank"; D = D.format(_) } else D = "form.htm?m=oa&form=inbox-process-form&id=" + _.id; return "<a target=\"{0}\" href=\"{1}\">{2}</a>".format(B, D, $) } this.$base.createGrid.call(this, { columns: [{ width: 80, header: "\u6d41\u6c34\u53f7", css: "c-flow-no c-cell-bold", renderer: function ($, _) { return A(_.record.flowNO, _) } }, { header: "\u6807\u9898", css: "c-title c-cell-bold", renderer: function ($, B) { var _ = B.record, $ = (_.type == "\u4e8b\u52a1" ? "" : "[" + _.type + "]") + _.title; B.el.dom.title = $; return A($, B) } }, { dataIndex: "creator", header: "\u53d1\u8d77\u4eba" }, { dataIndex: "assignTime", header: "\u65f6\u95f4", renderer: function ($, A) { return $.format(_.box.dt2Format) } }, { header: "", dataIndex: "id", renderer: function (A, B) { var $ = B.record; if ($.isBold) B.row.el.addClass("f-row-bold"); if ($.receiveTime) return $.receiveTime.format(_.box.dt2Format) + " \u5df2\u63a5\u6536"; if ($.completeTime) return $.completeTime.format(_.box.dt2Format) + " \u5df2\u529e\u7406"; return "\u672a\u63a5\u6536" } }, { header: "", dataIndex: "id", format: "<a class=a-button onclick=\"page.remove('{id}')\" href=# >\u5220\u9664</a>"}] }) } }); ["../themes/box-default/oa/css.css?" + _.pathPart].each(_.Style.loadCss); window.page = new _.box.InboxList(); page.show() } ()